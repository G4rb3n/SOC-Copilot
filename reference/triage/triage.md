## 工作流程
1、从用户输入的路径获取该目录下的所有告警日志，调用'{scripts/triage.py}'下的规则进行规则匹配，若规则匹配成功，则返回研判结论（定向攻击、自动化攻击、渗透测试、病毒木马、脆弱性风险、业务行为、未知），若输出的研判结论为非未知则跳过下面所有研判环节。
2、若输出的研判结论为未知，则解析用户输入的告警日志，根据告警日志中的告警名称、设备来源字段，快速判断属于哪种日志类型（network、endpoint）。
2、若为network日志类型，则提取告警名称、告警访问方向、数据包内容。告警日志里应该没有告警访问方向字段，但可以根据告警日志里的源IP和目的IP进行判断。数据包内容需要解析告警日志中的请求体、响应体、请求头、响应头进行拼接，如果拼接后的数据包经过编码，需要进行解码。
3、若为endpoint日志类型，则提取告警名称、进程链内容、文件内容。进程链需包含进程ID、进程文件路径、进程命令行、父进程ID、父进程文件路径、进程父进程命令行等信息，文件信息需包含文件路径、文件MD5、文件SHA256等信息。
4、根据告警名称判断该告警日志是属于哪种攻击类型，则根据攻击类型调用'{/model-engine/triage}'里对应的经验进行研判，返回研判结论（定向攻击、自动化攻击、渗透测试、病毒木马、脆弱性风险、业务行为、未知）和研判思维链。定向攻击指的是黑客真人攻击，自动化攻击指的是扫描器批量攻击，渗透测试指的内网漏扫行为（带有明显的test、vulscan等特征），病毒木马指的是僵木蠕勒索挖矿等低危告警，脆弱性风险指的是弱密码登录成功和未授权访问成功等告警，疑似攻击行为指的是无法分辨攻击还是业务的告警，业务行为指的是业务触发的误报，未知指的是数据不足无法给出准确结论。自动化攻击如果成功成功了，则改判为定向攻击。