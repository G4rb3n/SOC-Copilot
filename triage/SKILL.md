---
name: triage
description: 对告警进行研判分析，给出研判结论（定向攻击、自动化攻击、渗透测试、病毒木马、脆弱性风险、疑似攻击行为、业务行为）和研判思维链。
argument-hint: "[告警日志文件路径]"
---

## 工作流程
1、解析用户输入的告警日志，根据告警日志中的告警名称、设备来源字段，快速判断属于哪种日志类型（network、endpoint）。
2、若为network日志类型，则提取告警名称、告警访问方向、数据包内容。告警日志里应该没有告警访问方向字段，但可以根据告警日志里的源IP和目的IP进行判断。数据包内容需要解析告警日志中的请求体、响应体、请求头、响应头进行拼接，如果拼接后的数据包经过编码，需要进行解码。
3、若为endpoint日志类型，则提取告警名称、进程链内容、文件内容。进程链需包含进程ID、进程文件路径、进程命令行、父进程ID、父进程文件路径、进程父进程命令行等信息，文件信息需包含文件路径、文件MD5、文件SHA256等信息。
4、根据告警名称判断该告警日志是属于哪种攻击类型，然后调用scripts里对应的规则脚本进行规则匹配，若规则脚本匹配成功，则返回研判结论（定向攻击、自动化攻击、渗透测试、病毒木马、脆弱性风险、疑似攻击行为、业务行为）和研判思维链。
5、若规则脚本未匹配中，则根据攻击类型调用对应的refernce经验进行研判，返回研判结论（定向攻击、自动化攻击、渗透测试、病毒木马、脆弱性风险、疑似攻击行为、业务行为）和研判思维链。

## 输入参数
- 告警日志（JSON/文本格式）

## 输出参数
- 研判结论
- 研判思维链